<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Panel | Pure Han Korea</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100">

<header class="bg-black text-white p-4">
  <h1 class="text-2xl font-bold text-center">Pure Han Korea â€” Admin Panel</h1>
</header>

<main class="max-w-6xl mx-auto p-6">

  <h2 class="text-2xl font-bold mb-4">Orders</h2>

  <div id="orders" class="space-y-4"></div>

</main>

<script>
const API = "http://localhost:5000/api/orders";

async function loadOrders() {
  const res = await fetch(API);
  const orders = await res.json();
  const container = document.getElementById("orders");

  if (orders.length === 0) {
    container.innerHTML = "<p>No orders yet.</p>";
    return;
  }

  container.innerHTML = orders.map(o => `
    <div class="bg-white p-4 rounded shadow">
      <p><b>Order ID:</b> ${o.id}</p>
      <p><b>Total:</b> Rs ${o.total}</p>
      <p><b>Payment:</b> ${o.paymentMethod}</p>
      <p><b>Status:</b> ${o.status}</p>

      <div class="mt-3 flex gap-2">
        <button onclick="updateStatus(${o.id}, 'Approved')"
          class="bg-green-600 text-white px-3 py-1 rounded">
          Approve
        </button>

        <button onclick="updateStatus(${o.id}, 'Rejected')"
          class="bg-red-600 text-white px-3 py-1 rounded">
          Reject
        </button>
      </div>
    </div>
  `).join("");
}

async function updateStatus(id, status) {
  await fetch(`${API}/${id}`, {
    method: "PUT",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ status })
  });
  loadOrders();
}

loadOrders();
</script>
<script>
const user = JSON.parse(localStorage.getItem("user"));

if (!user || user.role !== "admin") {
  alert("Access denied. Admin only.");
  window.location.href = "login.html";
}
</script>

</body>
</html>

